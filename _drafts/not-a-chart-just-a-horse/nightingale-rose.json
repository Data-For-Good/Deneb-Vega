{
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "description": "A basic radial plot that encodes two values as the angle and radius of an arc.",
  "width": 200,
  "height": 200,
  "data": [
    {
      "name": "dataset-csv",
      "url": "https://dl.dropboxusercontent.com/s/9kv2o9ajgrn9y62/data.csv",
      "format": {"type": "csv", "parse": "auto", "delimiter": ","}
    },
    {
      "name": "dataset",
      "source": "dataset-csv",
      "transform": [{"type": "pie", "signal": "1"}]
    },
    {"name": "pair", "values": ["1", "2"]}
  ],
  "scales": [
    {
      "name": "r",
      "type": "sqrt",
      "domain": {"data": "dataset", "field": "a"},
      "zero": true,
      "range": [0, 200]
    }
  ],
  "title": {
    "text": "DIAGRAM of the CAUSES of MORTALITY",
    "font": "Harrington",
    "subtitle": "In the Army in the East",
    "subtitleFont": "Cambria",
    "subtitleFontSize": 16
  },
  "marks": [
    {
      "type": "group",
      "layout": {
        "align": "all",
        "bounds": "full",
        "columns": {"signal": "2"},
        "offset": 200
      },
      "marks": [
        {
          "type": "group",
          "from": {"data": "pair"},
          "marks": [
            {
              "type": "arc",
              "from": {"data": "dataset"},
              "encode": {
                "enter": {
                  "dx": {"signal": "200"},
                  "x": {"field": {"group": "width"}, "mult": 0.5},
                  "y": {"field": {"group": "height"}, "mult": 0.5},
                  "startAngle": {"field": "startAngle"},
                  "endAngle": {"field": "endAngle"},
                  "innerRadius": {"value": 0},
                  "outerRadius": {
                    "scale": "r",
                    "signal": "parent.data==2?datum.a:datum.b/2"
                  },
                  "stroke": {"value": "#fff"}
                },
                "update": {"fill": {"value": "#CBD3D3"}},
                "hover": {"fill": {"value": "pink"}}
              }
            },
            {
              "type": "arc",
              "from": {"data": "dataset"},
              "encode": {
                "enter": {
                  "dx": {"signal": "200"},
                  "x": {"field": {"group": "width"}, "mult": 0.5},
                  "y": {"field": {"group": "height"}, "mult": 0.5},
                  "startAngle": {"field": "startAngle"},
                  "endAngle": {"field": "endAngle"},
                  "innerRadius": {"value": 0},
                  "outerRadius": {"scale": "r", "signal": "datum.a/3"},
                  "stroke": {"value": "#fff"}
                },
                "update": {"fill": {"value": "pink"}},
                "hover": {"fill": {"value": "pink"}}
              }
            },
            {
              "type": "text",
              "from": {"data": "dataset"},
              "encode": {
                "enter": {
                  "x": {"field": {"group": "width"}, "mult": 0.5},
                  "y": {"field": {"group": "height"}, "mult": 0.5},
                  "radius": {"scale": "r", "signal": "datum.a", "offset": 15},
                  "theta": {"signal": "(datum.startAngle + datum.endAngle)/2"},
                  "angle": {"signal": "0"},
                  "fill": {"value": "#000000"},
                  "align": {"value": "center"},
                  "baseline": {"value": "middle"},
                  "text": {"signal": "slice(datum.mmmm,0,3)"}
                }
              }
            }
          ]
        }
      ]
    },
    {
      "type": "text",
      "encode": {
        "update": {
          "x": {"value": -200},
          "y": {"value": 250},
          "width": {"value": 110},
          "lineBreak": {"value": "."},
          "text": {
            "value": "The Areas of the blue, red, & black wedges are each measured from the centre as the common vertex. The blue wedges measured from the centre of the circle represent area for area the deaths from Preventable or Mitigable Zymotic diseases. The red wedges measured from the centre the deaths from wounds, & the black wedges measured from the centre the deaths from all other causes. The black line across the red triangle in Nov. 1854 marks the boundary of the deaths from all other causes during the month. In October 1854, & April 1855, the black area coincides with the red, in January & February 1856, the blue coincides with the black. The entire areas may be compared by following the blue, the red, & the black lines enclosing them."
          }
        }
      }
    }
  ]
}
